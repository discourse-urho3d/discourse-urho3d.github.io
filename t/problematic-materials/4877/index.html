<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Problematic Materials</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Problematic Materials</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2384_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Leith</div>
          <div class="post_content">
<p>I have just used AssetExporter to export an FBX model to Urho’s file format.<br/>
When I load it into my sandbox application, which has a single Directional Light and a single Zone with soft ambient lighting, the character’s materials all appear somewhat dark.<br/>
Now when I rotate or move my character away from the world origin, it flickers very dark, and then becomes completey black!</p>
<p>So I tried hacking the material(s) to disable lighting, and sure enough, the problem disappeared.<br/>
Then I narrowed the problem down to the NormalMaps.</p>
<p>They are 2048x2048 pixel PNG images.<br/>
I tried using GIMP to convert them to DDS with DXT1 compression as advised in the Docs, and adjusted my material files to account for the change in filepath, but this failed to remedy the issue.</p>
<p>I’ve uploaded the exported files, and the original fbx file, hoping someone is willing to help me out, or at least confirm the issue with regards to normal maps <img alt=":slight_smile:" class="emoji" src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=6" title=":slight_smile:"/></p>
<aside class="onebox whitelistedgeneric">
<header class="source">
<img class="site-icon" height="32" src="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/b/b55b0e80a4a533be00e26d30756cb9b860ad76b1.png" width="32"/>
<a href="https://www.dropbox.com/s/3r6xdfkv6gsnnk5/Female.zip?dl=0" rel="nofollow noopener" target="_blank">Dropbox</a>
</header>
<article class="onebox-body">
<img class="thumbnail onebox-avatar" height="200" src="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/c/cd0b2b60285f09336dd8cbe470d3f9b65e147920.png" width="200"/>
<h3><a href="https://www.dropbox.com/s/3r6xdfkv6gsnnk5/Female.zip?dl=0" rel="nofollow noopener" target="_blank">Female.zip</a></h3>
<p>Shared with Dropbox</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2384_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Leith</div>
          <div class="post_content">
<p>Never mind, I found the answer.</p>
<p>AssetExporter does not by default generate or export vertex tangent data - even if the Material(s) specify a normal map. The solution is to provide the -t argument when performing the export.</p>
<aside class="quote no-group">
<blockquote>
<p>Models using a normal-mapped material need to have tangent vectors in their vertex data; the easiest way to ensure this is to use the switch -t (generate tangents) when using either AssetImporter or OgreImporter to import models to Urho3D format. If there are no tangents, the light attenuation on the normal-mapped material will behave in a completely erratic fashion.</p>
</blockquote>
</aside>
<p>The model DID have tangent information - it did not need to be generated by the exporter - yet the exporter by default will silently drop that information from the vertex data.</p>
<p>It would be nice if the exporter was clever enough to notice that one or more materials required tangents, and provided them on that basis?</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>